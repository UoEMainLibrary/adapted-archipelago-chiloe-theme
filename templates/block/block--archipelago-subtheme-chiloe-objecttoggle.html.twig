{# ====================================================== #}
{# Tabs Toggle - hidden by default, robust safe JS (no flash) #}
{# ====================================================== #}

{# Tab Buttons: hidden by default to avoid flashing #}
<ul id="customTabs" class="nav nav-tabs mb-3" style="display:none;">
  <li class="nav-item">
    <button class="nav-link active tab-btn" data-target="tab-1" type="button">Collection overview</button>
  </li>
  <li class="nav-item">
    <button class="nav-link tab-btn" data-target="tab-2" type="button">Items in Collection</button>
  </li>
</ul>


<script>
(function () {
  // run when DOM is ready
  function initTabs() {
    var tabContainer = document.getElementById('customTabs');
    if (!tabContainer) {
      // nothing to do
      return;
    }

    // gather buttons inside the container only
    var allButtons = Array.prototype.slice.call(tabContainer.querySelectorAll('.tab-btn'));
    if (!allButtons.length) {
      return; // no buttons to show
    }

    var validButtons = [];

    allButtons.forEach(function (btn) {
      var targetId = String(btn.dataset.target || '').trim();
      if (!targetId) {
        var li = btn.closest('li');
        if (li) li.style.display = 'none';
        else btn.style.display = 'none';
        return;
      }

      var pane = document.getElementById(targetId);
      if (pane) {
        validButtons.push(btn);
        var li = btn.closest('li');
        if (li) li.style.display = '';
        btn.style.display = '';
      } else {
        var li2 = btn.closest('li');
        if (li2) li2.style.display = 'none';
        else btn.style.display = 'none';
      }
    });

    if (!validButtons.length) {
      tabContainer.style.display = 'none';
      return;
    }

    tabContainer.style.display = '';

    var firstBtn = validButtons[0];
    validButtons.forEach(function(b){ b.classList.remove('active'); });
    firstBtn.classList.add('active');
    var firstPane = document.getElementById(firstBtn.dataset.target);
    if (firstPane) firstPane.style.display = 'block';

    function hideAllValidPanes() {
      validButtons.forEach(function(b){
        var p = document.getElementById(b.dataset.target);
        if (p) p.style.display = 'none';
      });
    }

    validButtons.forEach(function (btn) {
      btn.addEventListener('click', function (e) {
        e.preventDefault();
        var targetId = btn.dataset.target;
        if (!targetId) return;

        hideAllValidPanes();
        var target = document.getElementById(targetId);
        if (target) {
          target.style.display = 'block';
          if (typeof Drupal !== 'undefined' && typeof Drupal.attachBehaviors === 'function') {
            var settings = (typeof drupalSettings !== 'undefined') ? drupalSettings : {};
            try {
              Drupal.attachBehaviors(target, settings);
            } catch (err) {
              console.warn('Drupal.attachBehaviors failed for', targetId, err);
            }
          }
        }

        validButtons.forEach(function(b){ b.classList.remove('active'); });
        btn.classList.add('active');
      });
    });
  }

  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initTabs);
  } else {
    initTabs();
  }

})();
</script>

{#<style>#}
{#.custom-tab-pane { display: none; padding: 1rem 0; border-top: 1px solid #dee2e6; }#}
{#</style>#}
